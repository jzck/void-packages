# Template file for 'chefdk'
pkgname=chefdk
version=4.7.73
revision=1
archs="x86_64"
wrksrc=chefdk
create_wrksrc=yes
short_desc="ChefDK contains all the tools to interact with Chef"
maintainer="Jack Halford <jack@0x5.be>"
license="custom:Commercial"
homepage="https://downloads.chef.io"
distfiles="https://packages.chef.io/files/stable/chefdk/${version}/debian/9/chefdk_${version}-1_amd64.deb"
checksum=731a119c073d724410e54ebe843fa5a72faa4e36ddf8c9006cfb2a8b71368314
repository=nonfree
nostrip=yes
noshlibprovides=yes
noverifyrdeps=yes
restricted=yes

do_extract() {
	mkdir -p ${DESTDIR}
	ar x ${XBPS_SRCDISTDIR}/chefdk-${version}/chefdk_${version}-1_amd64.deb data.tar.xz
}

do_install() {
	bsdtar xf data.tar.xz -C ${DESTDIR}
	vbin ${DESTDIR}/opt/chefdk/bin/delivery
	vbin ${DESTDIR}/opt/chefdk/bin/kitchen
	vbin ${DESTDIR}/opt/chefdk/bin/foodcritic
	vbin ${DESTDIR}/opt/chefdk/bin/chef-vault
	vbin ${DESTDIR}/opt/chefdk/bin/inspec
	vbin ${DESTDIR}/opt/chefdk/bin/chef-apply
	vbin ${DESTDIR}/opt/chefdk/bin/chef-shell
	vbin ${DESTDIR}/opt/chefdk/bin/cookstyle
	vbin ${DESTDIR}/opt/chefdk/bin/chef-solo
	vbin ${DESTDIR}/opt/chefdk/bin/berks
	vbin ${DESTDIR}/opt/chefdk/bin/chef
	vbin ${DESTDIR}/opt/chefdk/bin/knife
	vbin ${DESTDIR}/opt/chefdk/bin/ohai
	vbin ${DESTDIR}/opt/chefdk/bin/dco
	vlicense ${DESTDIR}/opt/chefdk/LICENSE
}
